{% set name = "gwdetchar" %}
{% set version = "2.0.5" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 4f39363a7af48259ebf3962a9c357112f1bfbe4c4ee70c1f73a9f1913b1c9ddb
  patches:
    # https://github.com/gwdetchar/gwdetchar/pull/400
    - no-lalsuite.patch

build:
  number: 1
  script: {{ PYTHON }} -m pip install . -vv
  noarch: python
  entry_points:
    - gwdetchar-conlog = gwdetchar.conlog:main
    - gwdetchar-lasso-correlation = gwdetchar.lasso.__main__:main
    - gwdetchar-mct = gwdetchar.mct:main
    - gwdetchar-nagios = gwdetchar.nagios.__main__:main
    - gwdetchar-omega = gwdetchar.omega.__main__:main
    - gwdetchar-omega-batch = gwdetchar.omega.batch:main
    - gwdetchar-overflow = gwdetchar.overflow:main
    - gwdetchar-scattering = gwdetchar.scattering.__main__:main
    - gwdetchar-scattering-simple = gwdetchar.scattering.simple:main
    - gwdetchar-slow-correlation = gwdetchar.lasso.old:main
    - gwdetchar-software-saturations = gwdetchar.saturation.__main__:main

requirements:
  host:
    - pip
    - python >=3.6
    - setuptools >=20.2.2
  run:
    - astropy >=3.0.0
    - beautifulsoup4
    - coloredlogs
    - gwdatafind
    - gwpy >=2.0.0
    - gwtrigfind
    - lscsoft-glue >=2.0.0
    - lxml
    - markuppy >=1.14
    - matplotlib-base >=3.1.0
    - numpy >=1.16
    - pandas
    - pycondor
    - python >=3.6
    - pygments >=2.7.3
    - pytz
    - python-ldas-tools-framecpp
    - scikit-learn
    - scipy >=1.2.0

test:
  requires:
    - flake8
    - pip
    - pytest >=3.3.0
    - pytest-cov >2.4.0
    # https://github.com/gwdetchar/gwdetchar/issues/411
    - python <3.10.0a0
    # https://github.com/gwdetchar/gwdetchar/issues/409
    - pygments < 2.11.0a0
  commands:
    # check requirements
    - python -m pip check
    # run unit tests
    - python -m pytest -ra --verbose --pyargs {{ name }}
    # check scripts run ok
    - python -m gwdetchar.conlog --help
    - python -m gwdetchar.lasso --help
    - python -m gwdetchar.lasso.old --help
    - python -m gwdetchar.mct --help
    - python -m gwdetchar.nagios --help
    - python -m gwdetchar.omega --help
    - python -m gwdetchar.omega.batch --help
    - python -m gwdetchar.overflow --help
    - python -m gwdetchar.saturation --help
    - python -m gwdetchar.scattering --help
    - python -m gwdetchar.scattering.simple --help
    # check entry points
    - gwdetchar-conlog --help
    - gwdetchar-lasso-correlation --help
    - gwdetchar-mct --help
    - gwdetchar-nagios --help
    - gwdetchar-omega --help
    - gwdetchar-omega-batch --help
    - gwdetchar-overflow --help
    - gwdetchar-scattering --help
    - gwdetchar-scattering-simple --help
    - gwdetchar-slow-correlation --help
    - gwdetchar-software-saturations --help

about:
  home: https://gwdetchar.readthedocs.io
  license: GPL-3.0-or-later
  license_family: GPL
  license_file: LICENSE
  summary: A python package for gravitational-wave detector characterisation
  description: |
    This package provides a set of python utilities for gravitational-wave
    detector characterisation and data quality.

extra:
  recipe-maintainers:
    - alurban
    - duncanmmacleod
    - eagoetz
    - areeda
    - robertbruntz
